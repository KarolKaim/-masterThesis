\chapter{Eksperymenty}

W niniejszym rozdziale przedstawiony został krótki opis środowiska testowego oraz przebieg testów układu do zmiany przełożeń.

\section{Środowisko testowe}
Wszystkie eksperymenty przeprowadzone zostały w sposób stacjonarny. Zamontowanie roweru na dedykowanym stojaku umożliwia swobodną symulację dowolnych scenariuszy testowych. Akwizcyja danych sterownika układu jest w takim przypadku zdecydowanie mniej problematyczna, ponieważ nie jest konieczne stosowanie protokołów transmisji bezprzewdowej. 
Na potrzeby testów, wykonana została aplikacja przedstawiająca, w formie przebiegów czasowych, kluczowe parametry układu. Wykorzystano język C++ oraz zestaw bibliotek Qt. Komunikacja pomiędzy sterownikiem a aplikacją nawiązana została za pomocą intefrejsu szeregowego UART(ang. \textit{Universal Asynchronous Receiver and Transmitter}). Sterownik pracujący w trybie testowania, wysyła zastaw danych do komputera PC z częstotliwością 20Hz. Zestaw danych, składa się z chwilowych wartości:
\begin{itemize}
 \item
 kąta nachylenia podłoża,
 \item
 kadencji,
 \item
 prędkości liniowej roweru,
 \item
 wybranego biegu,
 \item
 stanu przycisku redukującego przełożenie,
 \item
 stanu przycisku zwiększającego przełożenie,
 \item
 trybu pracy sterownia.
 \end{itemize}
 
We wszystkich trybach automatycznych przedstawione są również przyjęte zakresy kadencji, a w trybie sportowym dodatkowo zakres kąta nachylenia podłoża.
 
\section{Wyniki tesów}

Poniżej zaprezentowano wyniki testów wybranych scenariuszy, potwierdzające zgodność działania sterownika układu z założeniami, przedstawionymi w pkt. \textcolor{red}{pktFinalny}
\subsection{Tryb ręczny}
Podstawowa funkcjonalność układu to zmiana przełożeń w trybie ręcznym. Naciśnięcie odpowiedniego przycisku powoduje zmianę przełożenia.
 
\begin{figure}[h]
    \centering
    \includegraphics[scale=0.36]{tests_randomChange1.jpg}
    \caption{Zmiana przełożeń w trybie ręcznym}
    \label{fig:tests_randomChange}
\end{figure}

Kolejna funkcjonalność to możliwość zmiany kilku przełożeń w wyniku naciśniecia i przytrzymania odpowiedniego przycisku. Funkcjonalność ciągłej zmiany przełożeń zaprojektowana została z myślą o możliwości szybkiego doboru przełożenia. Początkowo zakładano, że zmiana biegów wyzwalana będzie z częstotliwością 1Hz. Jednak w trakcie przeprowadzania eksperymentów uznano, że należy zmniejszyć opóźnienie pomiędzy kolejnymi zmianami, które ostatecznie wynosi 0.7 sekundy.

\begin{figure}[h]
    \centering
    \includegraphics[scale=0.36]{tests_continousChange.jpg}
    \caption{Ciągła zmiana przełożeń w trybie ręcznym}
    \label{fig:tests_continousChange}
\end{figure}
\subsection{Tryb comfort}
W trybie comfort przeprowadzono dwa scenariusze testowe. 

Pierwsza przetestowana funkcjonalność to utrzymywanie kadencji w zadanym zakresie. W trybie comfort kadencja powinna zostać utrzymana w zakresie od $45$ do $60$ obrotów na minutę. Szare linie naniesione na wykres kadencji obejmują ten zakres. Przebiegi zamieszczone na rys. \ref{fig:tests_continousChange} potwierdzają poprawne działanie tej funkcjonalności. W wyniku przekroczenia górnej granicy wartości kadencji następuje automatyczna zmiana przełożenia. Stan przycisków do zmiany ręcznej nie zmienia się. Przełożenie zmieniane jest dwukrotnie. Kolejne zmiany przełożeń nie są konieczne w wyniku stabilizacji wartości kadencji w zadanym zakresie. 
\begin{figure}[h]
    \centering
    \includegraphics[scale=0.36]{tests_trybComfort.jpg}
    \caption{Automatyczna zmiana przełożeń - tryb Comfort}
    \label{fig:tests_continousChange}
\end{figure}
Drugi scenariusz obejmuje sprawdzenie wyłączenia możłiwości ręcznej zmiany przełożeń. Przebiegi przedstawione na rys. \textcolor{red}{RYS!} potwierdzają poprawne działanie kontrolera.
\textcolor{red}{zlapac lepszy brak zmiany w trybie comfort}
\subsection{Tryb active}
\begin{figure}[h]
    \centering
    \includegraphics[scale=0.35]{tests_trybActive.jpg}
    \caption{Automatyczna zmiana przełożeń - tryb Active}
    \label{fig:tests_continousChange}
\end{figure}
\subsection{Tryb sport}

\begin{figure}[h]
    \centering
    \includegraphics[scale=0.36]{tests_trybSportDopasowanieBiegu.jpg}
    \caption{Dopasowanie przełożenia w wyniku zatrzymania pedałowania - tryb Sport}
    \label{fig:tests_continousChange}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[scale=0.36]{tests_trybSportZmianaBiegow.jpg}
    \caption{Automatyczna zmiana przełożeń - tryb Sport}
    \label{fig:tests_continousChange}
\end{figure}
